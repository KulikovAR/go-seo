definitions:
  dto.AsyncTrackPositionsResponse:
    properties:
      message:
        type: string
      status:
        type: string
      task_id:
        type: string
    type: object
  dto.CombinedPositionItem:
    properties:
      date:
        type: string
      id:
        type: integer
      keyword:
        type: string
      keyword_id:
        type: integer
      positions:
        items:
          $ref: '#/definitions/dto.PositionData'
        type: array
      site_id:
        type: integer
      wordstat:
        $ref: '#/definitions/dto.PositionData'
    type: object
  dto.CombinedPositionsResponse:
    properties:
      data:
        items:
          $ref: '#/definitions/dto.CombinedPositionItem'
        type: array
      meta:
        $ref: '#/definitions/dto.MetaInfo'
      pagination:
        $ref: '#/definitions/dto.PaginationInfo'
    type: object
  dto.CreateGroupRequest:
    properties:
      name:
        type: string
      site_id:
        type: integer
    required:
    - name
    - site_id
    type: object
  dto.CreateKeywordRequest:
    properties:
      group_id:
        type: integer
      site_id:
        type: integer
      value:
        type: string
    required:
    - site_id
    - value
    type: object
  dto.CreateSiteRequest:
    properties:
      domain:
        type: string
    required:
    - domain
    type: object
  dto.DeleteKeywordResponse:
    properties:
      message:
        type: string
    type: object
  dto.DeleteSiteResponse:
    properties:
      message:
        type: string
    type: object
  dto.ErrorResponse:
    properties:
      error:
        type: string
      message:
        type: string
    type: object
  dto.GroupResponse:
    properties:
      id:
        type: integer
      name:
        type: string
      site_id:
        type: integer
    type: object
  dto.KeywordResponse:
    properties:
      group_id:
        type: integer
      id:
        type: integer
      site_id:
        type: integer
      value:
        type: string
    type: object
  dto.MetaInfo:
    properties:
      cached:
        type: boolean
      query_time_ms:
        type: integer
    type: object
  dto.PaginationInfo:
    properties:
      current_page:
        type: integer
      from:
        type: integer
      has_more:
        type: boolean
      last_page:
        type: integer
      per_page:
        type: integer
      to:
        type: integer
      total:
        type: integer
    type: object
  dto.PositionData:
    properties:
      date:
        type: string
      rank:
        type: integer
      source:
        type: string
      title:
        type: string
      url:
        type: string
    type: object
  dto.PositionDistribution:
    properties:
      not_found:
        type: integer
      top_3:
        type: integer
      top_10:
        type: integer
      top_20:
        type: integer
    type: object
  dto.PositionHistoryItem:
    properties:
      country:
        type: string
      date:
        type: string
      device:
        type: string
      id:
        type: integer
      keyword:
        type: string
      keyword_id:
        type: integer
      lang:
        type: string
      position:
        type: integer
      rank:
        type: integer
      site_id:
        type: integer
      source:
        type: string
      title:
        type: string
      url:
        type: string
    type: object
  dto.PositionHistoryResponse:
    properties:
      data:
        items:
          $ref: '#/definitions/dto.PositionHistoryItem'
        type: array
      meta:
        $ref: '#/definitions/dto.MetaInfo'
      pagination:
        $ref: '#/definitions/dto.PaginationInfo'
    type: object
  dto.PositionRanges:
    properties:
      "1_3":
        type: integer
      "4_10":
        type: integer
      "11_30":
        type: integer
      "31_50":
        type: integer
      "51_100":
        type: integer
      100_plus:
        type: integer
      not_found:
        type: integer
    type: object
  dto.PositionResponse:
    properties:
      ads:
        type: boolean
      country:
        type: string
      date:
        type: string
      device:
        type: string
      id:
        type: integer
      keyword:
        type: string
      keyword_id:
        type: integer
      lang:
        type: string
      os:
        type: string
      pages:
        type: integer
      rank:
        type: integer
      site:
        type: string
      site_id:
        type: integer
      source:
        type: string
      title:
        type: string
      url:
        type: string
    type: object
  dto.PositionStatisticsRequest:
    properties:
      date_from:
        type: string
      date_to:
        type: string
      site_id:
        type: integer
      source:
        enum:
        - google
        - yandex
        - wordstat
        type: string
    required:
    - date_from
    - date_to
    - site_id
    - source
    type: object
  dto.PositionStatisticsResponse:
    properties:
      keywords_count:
        type: integer
      not_visible:
        type: integer
      position_distribution:
        $ref: '#/definitions/dto.PositionDistribution'
      position_ranges:
        $ref: '#/definitions/dto.PositionRanges'
      total_positions:
        type: integer
      trends:
        $ref: '#/definitions/dto.Trends'
      visibility_stats:
        $ref: '#/definitions/dto.VisibilityStats'
      visible:
        type: integer
    type: object
  dto.SiteResponse:
    properties:
      domain:
        type: string
      id:
        type: integer
      keywords_count:
        type: integer
      last_position_update:
        type: string
    type: object
  dto.TrackGooglePositionsRequest:
    properties:
      ads:
        type: boolean
      ai:
        type: integer
      country:
        type: string
      device:
        enum:
        - desktop
        - tablet
        - mobile
        type: string
      domain:
        type: integer
      filter:
        type: integer
      filter_group_id:
        type: integer
      highlights:
        type: integer
      lang:
        type: string
      loc:
        type: integer
      lr:
        type: integer
      nfpr:
        type: integer
      os:
        enum:
        - ios
        - android
        type: string
      pages:
        maximum: 10
        minimum: 1
        type: integer
      raw:
        type: string
      site_id:
        type: integer
      subdomains:
        type: boolean
      tbs:
        type: string
      xml_api_key:
        type: string
      xml_base_url:
        type: string
      xml_user_id:
        type: string
    required:
    - site_id
    type: object
  dto.TrackWordstatPositionsRequest:
    properties:
      regions:
        description: ID региона Яндекса, nullable
        type: integer
      site_id:
        type: integer
      xml_api_key:
        type: string
      xml_base_url:
        type: string
      xml_user_id:
        type: string
    required:
    - site_id
    type: object
  dto.TrackYandexPositionsRequest:
    properties:
      ads:
        type: boolean
      country:
        type: string
      device:
        enum:
        - desktop
        - tablet
        - mobile
        type: string
      filter:
        type: integer
      filter_group_id:
        type: integer
      groupby:
        type: integer
      highlights:
        type: integer
      inindex:
        type: integer
      lang:
        type: string
      lr:
        type: integer
      os:
        enum:
        - ios
        - android
        type: string
      pages:
        maximum: 10
        minimum: 1
        type: integer
      raw:
        type: string
      site_id:
        type: integer
      strict:
        type: integer
      subdomains:
        type: boolean
      within:
        type: integer
      xml_api_key:
        type: string
      xml_base_url:
        type: string
      xml_user_id:
        type: string
    required:
    - site_id
    type: object
  dto.TrackingJobItem:
    properties:
      completed_at:
        type: string
      completed_tasks:
        type: integer
      created_at:
        type: string
      error:
        type: string
      failed_tasks:
        type: integer
      id:
        type: string
      progress:
        description: Процент выполнения
        type: number
      site_id:
        type: integer
      source:
        type: string
      status:
        type: string
      total_tasks:
        type: integer
      updated_at:
        type: string
    type: object
  dto.TrackingJobsResponse:
    properties:
      data:
        items:
          $ref: '#/definitions/dto.TrackingJobItem'
        type: array
      meta:
        $ref: '#/definitions/dto.MetaInfo'
      pagination:
        $ref: '#/definitions/dto.PaginationInfo'
    type: object
  dto.Trends:
    properties:
      declined:
        type: integer
      improved:
        type: integer
      stable:
        type: integer
    type: object
  dto.UpdateGroupRequest:
    properties:
      name:
        type: string
    required:
    - name
    type: object
  dto.UpdateKeywordRequest:
    properties:
      group_id:
        type: integer
    type: object
  dto.VisibilityStats:
    properties:
      avg_position:
        type: number
      best_position:
        type: integer
      median_position:
        type: integer
      worst_position:
        type: integer
    type: object
info:
  contact: {}
paths:
  /api/groups:
    get:
      description: Get list of all groups for a specific site
      parameters:
      - description: Site ID
        in: query
        name: site_id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/dto.GroupResponse'
            type: array
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      summary: Get all groups
      tags:
      - groups
    post:
      consumes:
      - application/json
      description: Create a new group for organizing keywords
      parameters:
      - description: Group data
        in: body
        name: group
        required: true
        schema:
          $ref: '#/definitions/dto.CreateGroupRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/dto.GroupResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      summary: Create a new group
      tags:
      - groups
  /api/groups/{id}:
    delete:
      description: Delete a group
      parameters:
      - description: Group ID
        in: path
        name: id
        required: true
        type: integer
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      summary: Delete a group
      tags:
      - groups
    put:
      consumes:
      - application/json
      description: Update group name
      parameters:
      - description: Group ID
        in: path
        name: id
        required: true
        type: integer
      - description: Group data
        in: body
        name: group
        required: true
        schema:
          $ref: '#/definitions/dto.UpdateGroupRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.GroupResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      summary: Update a group
      tags:
      - groups
  /api/keywords:
    get:
      description: Get list of keywords for a specific site
      parameters:
      - description: Site ID
        in: query
        name: site_id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/dto.KeywordResponse'
            type: array
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      summary: Get keywords by site
      tags:
      - keywords
    post:
      consumes:
      - application/json
      description: Create a new keyword for tracking
      parameters:
      - description: Keyword data
        in: body
        name: keyword
        required: true
        schema:
          $ref: '#/definitions/dto.CreateKeywordRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/dto.KeywordResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      summary: Create a new keyword
      tags:
      - keywords
  /api/keywords/{id}:
    delete:
      description: Delete a keyword and all its tracking data
      parameters:
      - description: Keyword ID
        in: path
        name: id
        required: true
        type: integer
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.DeleteKeywordResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      summary: Delete a keyword
      tags:
      - keywords
    put:
      consumes:
      - application/json
      description: Update keyword group_id
      parameters:
      - description: Keyword ID
        in: path
        name: id
        required: true
        type: integer
      - description: Keyword update data
        in: body
        name: keyword
        required: true
        schema:
          $ref: '#/definitions/dto.UpdateKeywordRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.KeywordResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      summary: Update keyword group
      tags:
      - keywords
  /api/positions/combined:
    get:
      consumes:
      - application/json
      description: Get paginated combined positions from multiple sources
      parameters:
      - description: Site ID
        in: query
        name: site_id
        required: true
        type: integer
      - description: Source (google, yandex)
        in: query
        name: source
        type: string
      - description: Include Wordstat data
        in: query
        name: wordstat
        type: boolean
      - description: Sort by Wordstat positions (asc or desc)
        in: query
        name: wordstat_sort
        type: string
      - description: Start date (YYYY-MM-DD)
        in: query
        name: date_from
        type: string
      - description: End date (YYYY-MM-DD)
        in: query
        name: date_to
        type: string
      - description: Date for sorting by position (YYYY-MM-DD). Must be within date_from
          and date_to range
        in: query
        name: date_sort
        type: string
      - description: 'Sort type for positions (asc or desc). Default: asc'
        in: query
        name: sort_type
        type: string
      - description: Minimum rank filter
        in: query
        name: rank_from
        type: integer
      - description: Maximum rank filter
        in: query
        name: rank_to
        type: integer
      - description: Filter by keyword group ID
        in: query
        name: group_id
        type: integer
      - description: Page number (default 1)
        in: query
        name: page
        type: integer
      - description: Items per page (default 50, max 100)
        in: query
        name: per_page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.CombinedPositionsResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      summary: Get combined positions
  /api/positions/history:
    get:
      consumes:
      - application/json
      description: Get paginated positions history with filtering options
      parameters:
      - description: Site ID
        in: query
        name: site_id
        required: true
        type: integer
      - description: Keyword ID
        in: query
        name: keyword_id
        type: integer
      - description: Source (google, yandex, wordstat)
        in: query
        name: source
        type: string
      - description: Start date (YYYY-MM-DD)
        in: query
        name: date_from
        type: string
      - description: End date (YYYY-MM-DD)
        in: query
        name: date_to
        type: string
      - description: Get only last positions
        in: query
        name: last
        type: boolean
      - description: Page number (default 1)
        in: query
        name: page
        type: integer
      - description: Items per page (default 50, max 100)
        in: query
        name: per_page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.PositionHistoryResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      summary: Get positions history
  /api/positions/latest:
    get:
      consumes:
      - application/json
      description: Get latest positions for all keywords
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/dto.PositionResponse'
            type: array
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      summary: Get latest positions
  /api/positions/statistics:
    post:
      consumes:
      - application/json
      description: Get position statistics for a site within date range
      parameters:
      - description: Statistics parameters
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/dto.PositionStatisticsRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.PositionStatisticsResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      summary: Get position statistics
  /api/positions/track-google:
    post:
      consumes:
      - application/json
      description: Start async Google position tracking for site keywords
      parameters:
      - description: Google tracking parameters
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/dto.TrackGooglePositionsRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.AsyncTrackPositionsResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      summary: Track Google positions
  /api/positions/track-wordstat:
    post:
      consumes:
      - application/json
      description: Start async Wordstat position tracking for site keywords
      parameters:
      - description: Wordstat tracking parameters
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/dto.TrackWordstatPositionsRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.AsyncTrackPositionsResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      summary: Track Wordstat positions
  /api/positions/track-yandex:
    post:
      consumes:
      - application/json
      description: Start async Yandex position tracking for site keywords
      parameters:
      - description: Yandex tracking parameters
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/dto.TrackYandexPositionsRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.AsyncTrackPositionsResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      summary: Track Yandex positions
  /api/sites:
    get:
      description: Get list of tracked sites. If ids parameter is provided, returns
        only sites with specified IDs
      parameters:
      - description: Comma-separated list of site IDs to filter by
        in: query
        name: ids
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/dto.SiteResponse'
            type: array
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      summary: Get sites
      tags:
      - sites
    post:
      consumes:
      - application/json
      description: Create a new site for tracking
      parameters:
      - description: Site data
        in: body
        name: site
        required: true
        schema:
          $ref: '#/definitions/dto.CreateSiteRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/dto.SiteResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      summary: Create a new site
      tags:
      - sites
  /api/sites/{id}:
    delete:
      description: Delete a site and all its tracking data
      parameters:
      - description: Site ID
        in: path
        name: id
        required: true
        type: integer
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.DeleteSiteResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      summary: Delete a site
      tags:
      - sites
  /api/tracking-jobs:
    get:
      consumes:
      - application/json
      description: Возвращает постраничный список джобов отслеживания позиций с возможностью
        фильтрации по сайту и статусу
      parameters:
      - description: ID сайта для фильтрации
        in: query
        name: site_id
        type: integer
      - description: Статус джоба (pending, running, completed, failed, cancelled)
        in: query
        name: status
        type: string
      - description: Номер страницы (по умолчанию 1)
        in: query
        name: page
        type: integer
      - description: Количество записей на странице (по умолчанию 20, максимум 100)
        in: query
        name: per_page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.TrackingJobsResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      summary: Получить список джобов с пагинацией
      tags:
      - tracking-jobs
swagger: "2.0"
