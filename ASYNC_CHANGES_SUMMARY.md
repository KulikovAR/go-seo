# Изменения в системе асинхронного парсинга

## Что было исправлено

### 1. Добавлена поддержка переменных окружения
- **WORKER_COUNT** - количество параллельных worker'ов
- **BATCH_SIZE** - размер батча ключевых слов

### 2. Обновлена конфигурация
- Добавлена структура `AsyncConfig` в `config.go`
- Переменные окружения теперь корректно загружаются
- Значения по умолчанию: WORKER_COUNT=10, BATCH_SIZE=50

### 3. Обновлен main.go
- Теперь использует значения из конфигурации вместо хардкода
- `cfg.Async.WorkerCount` и `cfg.Async.BatchSize`

## Как управлять параметрами

### Через .env файл
```env
WORKER_COUNT=10
BATCH_SIZE=50
```

### Через переменные окружения
```bash
export WORKER_COUNT=15
export BATCH_SIZE=75
```

## Безопасные значения

### Для небольших проектов (до 500 ключевых слов)
```env
WORKER_COUNT=5
BATCH_SIZE=25
```

### Для средних проектов (500-2000 ключевых слов)
```env
WORKER_COUNT=10
BATCH_SIZE=50
```

### Для крупных проектов (2000+ ключевых слов)
```env
WORKER_COUNT=20
BATCH_SIZE=100
```

## Ограничения

- **WORKER_COUNT**: 1-50 (рекомендуется 5-20)
- **BATCH_SIZE**: 1-200 (рекомендуется 25-100)

## Мониторинг

Следите за:
- Временем обработки батчей (норма: 30-120 сек)
- Количеством ошибок API (<5%)
- Использованием памяти (<1GB на 1000 ключевых слов)

## Файлы документации

- `ASYNC_CONFIG_GUIDE.md` - подробное руководство по настройке
- `async-config-example.env` - примеры конфигураций
