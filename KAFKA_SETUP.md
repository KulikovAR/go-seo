# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Kafka –¥–ª—è go-seo

## ‚úÖ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### 1. **KafkaService —Å HTTP API**
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –≤–Ω–µ—à–Ω–µ–º—É Kafka —á–µ—Ä–µ–∑ HTTP REST API
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–ø–∏–∫–æ–≤ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
- Graceful fallback –≤ log-only —Ä–µ–∂–∏–º –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ Kafka

### 2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–ø–∏–∫–æ–≤**
- `tracking-status` - –¥–ª—è —Å—Ç–∞—Ç—É—Å–æ–≤ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á
- `tracking-jobs` - –¥–ª—è —Å—Ç–∞—Ç—É—Å–æ–≤ –æ—Å–Ω–æ–≤–Ω—ã—Ö –∑–∞–¥–∞—á
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ç–æ–ø–∏–∫–æ–≤ –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º

### 3. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**
```bash
KAFKA_BROKERS=http://your-kafka-rest-api:8082
```

## üîß –ö–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å

### 1. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è**
```bash
# –í .env —Ñ–∞–π–ª–µ –∏–ª–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
export KAFKA_BROKERS="http://your-kafka-rest-api:8082"
```

### 2. **–§–æ—Ä–º–∞—Ç URL –¥–ª—è Kafka REST API**
```
http://kafka-rest-proxy:8082
```

### 3. **–ü—Ä–∏–º–µ—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏**

#### –î–ª—è Confluent Kafka REST Proxy:
```bash
KAFKA_BROKERS=http://localhost:8082
```

#### –î–ª—è Kafka REST API –Ω–∞ –¥—Ä—É–≥–æ–º –ø–æ—Ä—Ç—É:
```bash
KAFKA_BROKERS=http://kafka-server:8080
```

#### –î–ª—è –æ—Ç–∫–ª—é—á–µ–Ω–∏—è Kafka (log-only —Ä–µ–∂–∏–º):
```bash
KAFKA_BROKERS=""
```

## üìã –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–æ–±—â–µ–Ω–∏–π

### tracking-status —Ç–æ–ø–∏–∫:
```json
{
  "task_id": "task_abc123",
  "job_id": "job_def456", 
  "status": "completed",
  "timestamp": "2024-01-01T12:00:00Z",
  "error": "",
  "result": {
    "keyword_id": 123,
    "site_id": 456,
    "source": "google",
    "rank": 5,
    "url": "https://example.com",
    "title": "Example Title",
    "success": true
  }
}
```

### tracking-jobs —Ç–æ–ø–∏–∫:
```json
{
  "job_id": "job_def456",
  "status": "completed", 
  "error": "",
  "timestamp": "2024-01-01T12:00:00Z"
}
```

## üöÄ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

### 1. **–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:**
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å Kafka REST API
- –ï—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω - —Å–æ–∑–¥–∞—é—Ç—Å—è —Ç–æ–ø–∏–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –ï—Å–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω - –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ log-only —Ä–µ–∂–∏–º

### 2. **–ü—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏–π:**
- –ï—Å–ª–∏ Kafka –¥–æ—Å—Ç—É–ø–µ–Ω - –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤ —Ç–æ–ø–∏–∫–∏
- –ï—Å–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω - —Ç–æ–ª—å–∫–æ –ª–æ–≥–∏—Ä—É–µ—Ç –≤ –∫–æ–Ω—Å–æ–ª—å

### 3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
- Graceful degradation –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ Kafka
- –ü–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π retry –ø—Ä–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–±–æ—è—Ö

## üîç –õ–æ–≥–∏ –∏ –æ—Ç–ª–∞–¥–∫–∞

### –£—Å–ø–µ—à–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:
```
Kafka service initialized with brokers: [http://localhost:8082]
Topic tracking-status is ready
Topic tracking-jobs is ready
```

### Log-only —Ä–µ–∂–∏–º:
```
Kafka service initialized in log-only mode (no brokers configured)
Kafka message sent (log-only) - TaskID: task_123, JobID: job_456, Status: completed
```

### –û—à–∏–±–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:
```
Warning: Kafka connection failed: failed to connect to Kafka: Get "http://localhost:8082/topics": dial tcp [::1]:8082: connect: connection refused. Service will work in log-only mode.
```

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

1. **–ë–µ–∑ –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É Go
2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–ø–∏–∫–æ–≤** - –Ω–µ —Ç—Ä–µ–±—É–µ—Ç —Ä—É—á–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
3. **Graceful degradation** - —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–∞–∂–µ –±–µ–∑ Kafka
4. **–ü—Ä–æ—Å—Ç–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** - —Ç–æ–ª—å–∫–æ –æ–¥–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è
5. **–ü–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏** - –ª–µ–≥–∫–æ –æ—Ç–ª–∞–∂–∏–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- Kafka REST API –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ HTTP
- –¢–æ–ø–∏–∫–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (retention 7 –¥–Ω–µ–π)
- –ü—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ Kafka —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤ log-only —Ä–µ–∂–∏–º–µ
- –í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
